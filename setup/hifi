#!/bin/bash

function usage() {
    echo "--save, --install, --update"
    echo "the process is controlled by systemd to to restart stop etc. use systemctrl restart hifi.service"

}

function doSave() {



echo "saving..."



}


function getRepo {

git fetch --tags

LATEST=$(git describe --abbrev=0 --tags)

echo "checking out " $LATEST
sleep 2
git checkout $LATEST

}


BUILDDIR="/opt/hifi/build"

function changeowner  {
  if [ -d "$BUILDDIR" ]; then
    chown -R hifi:hifi $BUILDDIR
  fi
}



function getStatus() {
systemctl status hifi.service
}


function doRestore() {


echo $1
}

if [ "$2" != "" ];
then
    echo "Single argument only."
    exit
fi

    case $1 in
        --help)
            usage
            exit
            ;;
        --save)
            doSave
            ;;
        --status)
            echo "status"
            ;;
        --update)
            echo "update"
            ;;
        --restore)
            echo "Listing backup files:"

            for FILE in "/opt/hifi/backups"/*
            do
              echo "$FILE"
            done

            read -p 'File?' CHOSENFILE
            echo "Using:" $CHOSENFILE

            doRestore $CHOSENFILE
            ;;
        *)
            echo "ERROR: unknown parameter \"$1\""
            usage
            exit 1
            ;;
    esac
    shift
